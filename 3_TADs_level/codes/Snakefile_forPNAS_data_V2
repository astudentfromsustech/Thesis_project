samples = ['WT', 'HS']

rule all:
    input:
        expand("../data/PNAS_data_V2/S2_cool_10k/{sample}_combined_10000.cool", sample=samples),
        expand("../data/PNAS_data_V2/S2_cool_10k_targetChroms/{sample}_combined_10000_targetChroms.cool", sample=samples),
        expand("../data/PNAS_data_V2/S2_cool_10k_targetChroms_normalize0_1/{sample}_combined_10000_targetChroms_normalize0_1.cool", sample=samples),
        expand("../data/PNAS_data_V2/S2_cool_10k_targetChroms_normalize0_1_correctionKR_forNormalize0_1/{sample}_combined_10000_targetChroms_normalize0_1_correctionKR_forNormalize0_1.cool", sample=samples),




rule hic_to_cool:
    input:
        "../data/PNAS_data_V2/S2_hic_PNAS/{sample}_combined_PNAS.hic"
    output:
        "../data/PNAS_data_V2/S2_cool_10k/{sample}_combined_10000.cool"
    params:
        output_name="../data/PNAS_data_V2/S2_cool_10k/{sample}_combined.cool"
    shell:
        "hicConvertFormat -m {input} --inputFormat hic --outputFormat cool -o {params.output_name} -r 10000"

rule take_targetChroms:
    input:
        "../data/PNAS_data_V2/S2_cool_10k/{sample}_combined_10000.cool"
    output:
        "../data/PNAS_data_V2/S2_cool_10k_targetChroms/{sample}_combined_10000_targetChroms.cool"
    shell:
        " hicAdjustMatrix -m {input} --action keep --chromosomes 2L 2R 3L 3R 4 X -o {output}"
#
#
rule normalize_0_1:
    input:
        "../data/PNAS_data_V2/S2_cool_10k_targetChroms/{sample}_combined_10000_targetChroms.cool"
    output:
        "../data/PNAS_data_V2/S2_cool_10k_targetChroms_normalize0_1/{sample}_combined_10000_targetChroms_normalize0_1.cool"
    shell:
        "hicNormalize -m {input} --normalize norm_range -o {output}"
#
rule correction_KR_forNormalize0_1:
    input:
        "../data/PNAS_data_V2/S2_cool_10k_targetChroms_normalize0_1/{sample}_combined_10000_targetChroms_normalize0_1.cool"
    output:
        "../data/PNAS_data_V2/S2_cool_10k_targetChroms_normalize0_1_correctionKR_forNormalize0_1/{sample}_combined_10000_targetChroms_normalize0_1_correctionKR_forNormalize0_1.cool"
    shell:
        "hicCorrectMatrix correct -m {input} --correctionMethod KR --outFileName {output}"

# rule hicFindTADs_for_Normalize0_1:
#     input:
#         "../data/PNAS_data_V2/S2_cool_10k_targetChroms_normalize0_1_correctionKR_forNormalize0_1/{sample}_combined_10000_targetChroms_normalize0_1_correctionKR_forNormalize0_1.cool"
#     output:
#         "../data/PNAS_data_V2/S2_cool_10k_targetChroms_normalize0_1_correctionKR_forNormalize0_1/{sample}_combined_10000_targetChroms_normalize0_1_correctionKR_forNormalize0_1.cool"
#     shell:
#         "hicCorrectMatrix correct -m {input} --correctionMethod KR --outFileName {output}"




